import pandas as pd

file_path = r"Z:\mmd2pg.xlsx"
df = pd.read_excel(file_path)

mapped = []
for _, row in df.iterrows():
    year = int(row["year"])
    consumption = int(row["consumption"])
    mapped.append((year, consumption))

print("mapped output:")
print(mapped)

reducer = {}
for year, consumption in mapped:
    if year in reducer:
        reducer[year] = max(reducer[year], consumption)
    else:
        reducer[year] = consumption

print("\nmax electricity consumption/year:")
for year, consumption in sorted(reducer.items()):
    print(f"year:{year}, max consumption:{consumption}")
